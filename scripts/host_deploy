# This script will sit on the host you want to deploy the site too.
# This should live wherever the home directory is

AES_PASS=$1

cd ~
rm -rf ryankrol.co.uk-api
git clone https://github.com/RyanMKrol/ryankrol.co.uk-api.git
cd ryankrol.co.uk-api
openssl aes-256-cbc -d -a -in credentials/lastfmConfig.json.enc -out credentials/lastfmConfig.json -k $AES_PASS
git pull
npm install
npm run build
pm2 delete ryankrol.co.uk-api
pm2 start build/bin/www.js --name ryankrol.co.uk-api
pm2 save
